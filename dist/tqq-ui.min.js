var dir=angular.module("tqq.ui",[]);
dir.factory("loading",function(){var e=!0;return{show:function(o){if(e){var d=document.createElement("section");d.className="load-box",document.body.style.overflowY="hidden",document.body.appendChild(d),document.getElementsByClassName("load-box")[0].innerHTML=' <div class="load-container"><div class="loader"></div></div>',e=!1}},hide:function(){var o=document.getElementsByClassName("load-box")[0];if(o)return document.body.removeChild(o),document.body.style.overflowY="auto",void(e=!0)}}});
dir.directive("tqqPagination",["$parse",function(e){function a(e,a,t,s){var i=[],n=Math.ceil(e/a),l=Math.ceil(t/2),g=Math.floor(t/2);if(n<=t)for(var r=1;r<=n;r++)i.push(r);else if(s<=l)for(var o=1;o<=t;o++)i.push(o);else if(s>l&&s+g<=n){var p=s-l+1,d=s-l+t;for(p;p<=d;p++)i.push(p)}else if(s>l&&s+g>n)for(var c=n-t+1;c<=n;c++)i.push(c);return i}function t(e,a){for(var t=[],s=Math.ceil(e/a),i=1;i<=s;i++)t.push(i);return t}return{restrict:"EA",replace:!0,require:"?ngModel",scope:{ngModel:"<",totalItems:"<",maxSize:"<",itemsPerPage:"=",hideLast:"<",itemSelectHide:"<"},link:function(e,s,i,n){function l(){e.itemsPerPage=e.itemsPerPage||10,e.maxSize=e.maxSize||5,e.naModel=e.ngModel||1,e.pageNum=Math.ceil(e.totalItems/e.itemsPerPage),e.pageArr=a(e.totalItems,e.itemsPerPage,e.maxSize,e.ngModel),e.allPageArr=t(e.totalItems,e.itemsPerPage)}if(!i.totalItems)throw'"tqqPagination"---"total-items" is undefined \n 中文:"total-items"为必传参数。';e.atrs=i,e.$watch("totalItems",function(e){if(e){if(!angular.isNumber(e))throw'"tqqPagination"---"total-items" type error \n 中文:"total-items"类型错误，必须是number类型。';l()}}),e.$watch("itemsPerPage",function(a){if(a){l();var t=e.ngModel*e.itemsPerPage;t>e.totalItems&&(e.ngModel=e.pageNum,n.$setViewValue(e.ngModel))}}),e.judge={first:"first",previous:"previous",next:"next",last:"last"},n.$formatters.push(function(t){t&&e.totalItems&&(e.pageArr=a(e.totalItems,e.itemsPerPage,e.maxSize||5,t))}),e.updatePage=function(t){switch(t){case e.judge.first:e.ngModel=1;break;case e.judge.previous:e.ngModel>1&&e.ngModel--;break;case e.judge.next:e.ngModel<e.pageNum&&e.ngModel++;break;case e.judge.last:e.ngModel=e.pageNum;break;default:e.pageSelect=!1,e.ngModel=t}n.$setViewValue(e.ngModel),e.pageArr=a(e.totalItems,e.itemsPerPage,e.maxSize||5,e.ngModel)},e.updateItem=function(a){e.pageSelect=!1,e.itemsPerPage=a},e.updateShow=function(){e.pageSelect=!e.pageSelect},e.dismissSelect=function(){e.pageSelect=!1}},template:'<nav><div class="page-box" ng-if="pageSelect" ng-click="dismissSelect()"></div><ul class="pagination mg-none {{atrs.sizeClass}}"><li ng-if="!hideLast" ng-class="{disabled:ngModel===1}"><a href  ng-click="updatePage(judge.first)"><span ng-if="atrs.firstText">{{atrs.firstText}}</span><span  ng-if="!atrs.firstText"　class="anniu">&laquo;</span></a></li><li ng-class="{disabled:ngModel===1}"><a href  ng-click="updatePage(judge.previous)"><span ng-if="atrs.previousText">{{atrs.previousText}}</span><span  ng-if="!atrs.previousText"　class="anniu">&lsaquo;</span></a></li><li ng-repeat="val in pageArr track by $index" ng-class="{active:ngModel===val}"><a href ng-click="updatePage(val)">{{val}}</a></li><li ng-class="{disabled:ngModel===pageNum}"><a href  ng-click="updatePage(judge.next)"><span ng-if="atrs.nextText">{{atrs.nextText}}</span><span  ng-if="!atrs.nextText"　class="anniu">&rsaquo;</span></a></li><li ng-if="!hideLast" ng-class="{disabled:ngModel===pageNum}"><a href  ng-click="updatePage(judge.last)"><span ng-if="atrs.lastText">{{atrs.lastText}}</span><span  ng-if="!atrs.lastText"　class="anniu">&raquo;</span></a></li></ul><ul ng-if="!itemSelectHide" class="pagination pagination-init page-num-this {{atrs.sizeClass}}"><li><a href ng-click="updateShow()" ng-class="{active:pageSelect}">{{ngModel}}/{{pageNum}}</a><div class="page-list" ng-show="pageSelect"><div>每页显示</div><span ng-repeat="data in [10,20,50,100,200] track by $index" ng-class="{active:itemsPerPage===data}" ng-click="updateItem(data)">{{data}}</span><div>页&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp码</div><span ng-repeat="data in allPageArr track by $index" ng-class="{active:ngModel===data}" ng-click="updatePage(data)">{{data}}</span></div>'}}]);
dir.directive("tqqTable",function(){return{restrict:"EA",replace:!0,require:"?ngModel",scope:{tableData:"=",tableOptions:"=",tqqClick:"&",tableChecked:"="},link:function(e,t,l,a){e.$watch("tableData",function(e){if(e&&!angular.isArray(e))throw"table-data属性的值必须是一个数组"}),l.tableChecked&&(e.tableChecked=[],e.checkClick=function(){var t=[];e.tableData.length>0&&(e.allChecked||angular.forEach(e.tableData,function(e,l){t[l]=!0}),e.tableChecked=t)},e.$watch("tableChecked",function(t){if(e.tableData&&l.tableChecked){var i=0;angular.forEach(e.tableData,function(t,l){e.tableChecked[l]&&i++}),i==e.tableData.length?e.allChecked=!0:e.allChecked=!1,a&&a.$setViewValue({isAll:e.allChecked,isOne:1==i,isMany:i>0})}},!0)),e.tdClick=function(t,a,i){l.tqqClick&&e.tqqClick()(t,a,i),e.tableChecked&&"@"==a&&(e.tableChecked[i]=!e.tableChecked[i])}},template:'<table> <thead> <tr> <th ng-repeat="data in tableOptions track by $index" ng-if="!data.defaultHide" ng-class="{checkedNo:!allChecked,checkedYes:allChecked}"><div ng-if="data.name !== \'@\'">{{data.name}}</div><div ng-if="data.name === \'@\'" class="checkCtrl pointer" ng-click="checkClick()"></div></th> </tr> </thead> <tbody> <tr ng-if="!tableData"><td style="height:300px;" valign="middle" colspan="{{tableOptions.length}}">加载中...</td></tr><tr ng-if="tableData.length==0"><td style="height:300px;" valign="middle" colspan="{{tableOptions.length}}">没有数据</td></tr><tr ng-repeat="(key,value) in tableData track by $index" > <td ng-repeat="title in tableOptions track by $index" ng-class="{checkedNo:!tableChecked[key],checkedYes:tableChecked[key]}" ng-if="!title.defaultHide && !(title.field|tqqTableFieldIsArray)"><div class="{{title.class|tqqTableParse:value}}" ng-class = "{\'table-tr-hover\': title.isHover}" data-title = "{{title.isHover|tqqTableParse:value}}" ng-if="!title.isHtml && !(title.isHide|tqqTableParse:value)" ng-click="tdClick(value,title.judge,key)" ng-bind="title.field|tqqTableParse:value"></div><div class="{{title.class|tqqTableParse:value}}" ng-click="tdClick(value,title.judge,key)" ng-if="title.isHtml && !(title.isHide|tqqTableParse:value)" ng-class="{checkedNo:!tableChecked[key],checkedYes:tableChecked[key]}" ng-bind-html="title.field|tqqTableParse:value|toHtml"></div></td> <td ng-repeat="title in tableOptions track by $index" ng-if="!title.defaultHide && title.field|tqqTableFieldIsArray"><div ng-repeat=" child in title.field track by $index" ng-if="!child.isHtml && !(child.isHide|tqqTableParse:value)" ng-click="tdClick(value,child.judge,key)" class="{{child.class|tqqTableParse:value}}" ng-bind="child.field|tqqTableParse:value"></div><div ng-repeat=" child in title.field track by $index" ng-if="child.isHtml && !(child.isHide|tqqTableParse:value)" ng-click="tdClick(value,child.judge,key)" class="{{child.class|tqqTableParse:value}}" ng-bind-html="child.field|tqqTableParse:value|toHtml"></div></td> </tr> </tbody> </table> '}}).filter("tqqTableFieldIsArray",function(){return function(e){return angular.isArray(e)}}).filter("tqqTableParse",["$parse",function(e){return function(t,l){if(t)return"@"===t.substr(0,1)&&t.length>1?t.slice(1):"@"===t?'<div class="checkCtrl"></div>':e(t)(l)}}]).filter("toHtml",["$sce",function(e){return function(t){return e.trustAsHtml(t)}}]);